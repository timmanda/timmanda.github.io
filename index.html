<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test Document</title>

    <script src="js/modernizr.js"></script>
    <script src="js/pouchdb-2.2.3.min.js"></script>

    <style>
    table,th,td
    {
    border:1px solid black;
    border-collapse:collapse;
    }
    </style>
</head>

<body>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/themes/smoothness/jquery-ui.css" />
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.0/jquery-ui.min.js"></script>

    <script src="main.js"></script>

    <div id="bookentry" style="display: none;">
        <form id="bookform">
            <table style="width:300px">
                <tr>
                    <td align="right" style="width:10%">Author:</td>
                    <td><input type="text" id="authorname" style="width:98%"></td>
                </tr>
                <tr>
                    <td align="right" style="width:10%">Book:</td>
                    <td><input type="text" id="bookname" style="width:98%"></td>
                </tr>
                <tr>
                    <td></td>
                    <td><input type="submit" value="Submit" onclick="return addbook();"></td>
                </tr>
            </table>
        </form>
        <table style="width:300px;border-width:1px" id="booklist">
            <tr>
                <th style="width:30%">Author</th>
                <th>Book</th>
            </tr>
        </table>
    </div>

    <div id="loginentry">
        <form id="loginform">
            <table style="width:300px">
                <tr>
                    <td align="right" style="width:10%">Username:</td>
                    <td><input type="text" id="login_username" style="width:98%"></td>
                </tr>
                <tr>
                    <td align="right" style="width:10%">Password:</td>
                    <td><input type="password" id="login_password" style="width:98%"></td>
                </tr>
                <tr>
                    <td></td>
                    <td><input type="submit" value="Submit" id="loginbtn"></td>
                </tr>
            </table>
        </form>
    </div>

    <script>
        function DocReady()
        {
            if (localStorage.timmanda_username && localStorage.timmanda_password)
            {
                //$("#bookentry").slideToggle('slow', listbooks());
                //$("#loginentry").fadeOut('slow');
                $("#loginentry").hide();
                $("#bookentry").show();
            }

            $("#loginbtn").click(function () {
                localStorage.timmanda_username = $("#login_username").val();
                localStorage.timmanda_password = $("#login_password").val();

                //$("#bookentry").slideToggle('slow', listbooks());
                //$("#loginentry").fadeOut('slow');
                $("#loginentry").hide();
                $("#bookentry").show();

                event.preventDefault();
            });
        }

        jQuery(document).ready(function($){
            var deviceAgent = navigator.userAgent.toLowerCase();
            var agentID = deviceAgent.match(/(ipad|iphone|ipod)/i);
            if (agentID) {
                window.addEventListener('DOMContentLoaded',function() {
                    //The magic code to add show/hide custom event triggers
                    (function ($) {
                        $.each(['pageshow', 'pagehide'], function (i, ev) {
                            var el = $.fn[ev];
                            $.fn[ev] = function () {
                                this.trigger(ev);
                                return el.apply(this, arguments);
                            };
                        });
                    })(jQuery);

                    $("#bookentry").on('pageshow', function() {
                        //alert("Hi");
                        listbooks();
                    });

                    DocReady();
                });
            }
            else
            {
                $(document).ready(function () {
                    //The magic code to add show/hide custom event triggers
                    (function ($) {
                        $.each(['show', 'hide'], function (i, ev) {
                            var el = $.fn[ev];
                            $.fn[ev] = function () {
                                this.trigger(ev);
                                return el.apply(this, arguments);
                            };
                        });
                    })(jQuery);

                    $("#bookentry").on('show', function() {
                        //alert("Hi");
                        listbooks();
                    });

                    DocReady();
                });
            }
        });
    </script>
</body>
</html>
